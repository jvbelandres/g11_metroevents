(window.webpackJsonp=window.webpackJsonp||[]).push([["coachmark"],{"0PLU":function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return s})),a.d(t,"c",(function(){return d}));var n=a("ttJo"),i=a("keKk"),o=a("D57K"),r=a("Ybri");const c={clickAddTileButton:"clickAddTileButton",clickMyFeedPivotButton:"clickMyFeedPivotButton",clickPersonalizeButton:"clickPersonalizeButton",clickSettingsAdvancedButton:"clickSettingsAdvancedButton",clickSettingsButton:"clickSettingsButton",clickSettingsCloseButton:"clickSettingsCloseButton",clickSettingsCustomButton:"clickSettingsCustomButton",clickSettingsFocusedButton:"clickSettingsFocusedButton",clickSettingsInformationalButton:"clickSettingsInformationalButton",clickSettingsInspirationalButton:"clickSettingsInspirationalButton",clickVoiceSearchButton:"clickVoiceSearchButton",openEdgeBrowserNewWindow:"openEdgeBrowserNewWindow"},s={[c.clickAddTileButton]:()=>Object(i.b)(n.a),[c.clickMyFeedPivotButton]:()=>Object(i.b)(n.b),[c.clickPersonalizeButton]:()=>Object(i.b)(n.c),[c.clickSettingsAdvancedButton]:()=>Object(i.b)(n.e),[c.clickSettingsButton]:()=>Object(i.b)(n.f),[c.clickSettingsCloseButton]:()=>Object(i.b)(n.g),[c.clickSettingsCustomButton]:()=>Object(i.b)(n.i),[c.clickSettingsFocusedButton]:()=>Object(i.b)(n.j),[c.clickSettingsInformationalButton]:()=>Object(i.b)(n.k),[c.clickSettingsInspirationalButton]:()=>Object(i.b)(n.l),[c.clickVoiceSearchButton]:()=>Object(i.b)(n.m),[c.openEdgeBrowserNewWindow]:e=>Object(o.b)(void 0,void 0,void 0,(function*(){return e&&e.text&&Object(r.a)(e.text)?(window.open(e.text,"_blank").focus(),{actionCompleted:!0,status:"Window opened"}):{actionCompleted:!1,status:"No url provided"}}))},d="clickSettingsQuicklinksToggle"},"9s4i":function(e,t,a){"use strict";var n=a("mr4r"),i=a("QjXF");var o=function(e,t,a,n){for(var i=a-1,o=e.length;++i<o;)if(n(e[i],t))return i;return-1},r=a("clBK"),c=a("/XsO"),s=Array.prototype.splice;t.a=function(e,t,a,d){var l=d?o:i.a,h=-1,m=t.length,p=e;for(e===t&&(t=Object(c.a)(t)),a&&(p=Object(n.a)(e,Object(r.a)(a)));++h<m;)for(var u=0,g=t[h],b=a?a(g):g;(u=l(p,b,u,d))>-1;)p!==e&&s.call(p,u,1),s.call(e,u,1);return e}},E3bb:function(e,t,a){"use strict";var n=a("9s4i");t.a=function(e,t){return e&&e.length&&t&&t.length?Object(n.a)(e,t):e}},Gil3:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"f",(function(){return p})),a.d(t,"e",(function(){return u})),a.d(t,"c",(function(){return g})),a.d(t,"b",(function(){return k})),a.d(t,"h",(function(){return f})),a.d(t,"j",(function(){return v})),a.d(t,"i",(function(){return E})),a.d(t,"g",(function(){return C})),a.d(t,"d",(function(){return O}));var n,i,o=a("D57K"),r=a("HxRh"),c=a("XlyT"),s=a("tMmC"),d=a("0PLU"),l=a("keKk"),h=a("u5KZ"),m=a("HDSB");!function(e){e.pinMsnews="pinMsnews",e.tryInformationalMode="tryInformationalMode",e.tryInformationalModeDirect="tryInformationalModeDirect",e.tryInformationalModeProg="tryInformationalModeProg",e.tryPersonalizations="tryPersonalizations"}(n||(n={})),function(e){e.setDefaultBrowser="setDefaultBrowser"}(i||(i={}));const p=e=>()=>Object(o.b)(void 0,void 0,void 0,(function*(){const t=d.a[d.b.openEdgeBrowserNewWindow];return t?yield t({text:e}):null})),u=(e,t)=>{switch(e){case n.tryInformationalMode:return f(t);case n.tryInformationalModeDirect:return E();case n.tryInformationalModeProg:return v(t);case n.tryPersonalizations:return b()}},g=e=>{switch(e){case i.setDefaultBrowser:return(()=>{const e=new Promise(e=>{try{Object(m.a)()&&window&&window.chrome&&window.chrome.shellIntegrationPrivate&&"function"==typeof window.chrome.shellIntegrationPrivate.setDefaultBrowser?window.chrome.shellIntegrationPrivate.setDefaultBrowser(t=>{e({actionCompleted:t.success,status:t.message})}):(h.a.sendAppErrorEvent(Object.assign(Object.assign({},r.Sf),{message:"TargetActionLib: window.chrome.shellIntegrationPrivate.setDefaultBrowser chromium API not available"})),e({actionCompleted:!1,status:"set default browser api not available"}))}catch(t){Object(c.c)(t,r.Rf,"TargetActionLib: Exception executing window.chrome.shellIntegrationPrivate.setDefaultBrowser chromium API to set default browser to Edge"),e({actionCompleted:!1,status:JSON.stringify(t)})}});return()=>Object(o.b)(void 0,void 0,void 0,(function*(){return yield e}))})()}},b=()=>()=>Object(o.b)(void 0,void 0,void 0,(function*(){let e;const t=d.a[d.b.clickPersonalizeButton];return t&&(e=yield t({})),s.a.log(`Action completed: ${e.actionCompleted} status: ${e.status}`),e})),k=()=>()=>Object(o.b)(void 0,void 0,void 0,(function*(){let e;const t=d.a[d.b.clickVoiceSearchButton];return t&&(e=yield t({})),s.a.log(`Action completed: ${e.actionCompleted} status: ${e.status}`),e})),f=e=>()=>Object(o.b)(void 0,void 0,void 0,(function*(){let t;return t=yield y(),yield Object(l.a)(e||1e3),t=yield x(),t})),v=e=>()=>Object(o.b)(void 0,void 0,void 0,(function*(){let t;t=yield y(),yield Object(l.a)(e||1e3),t=yield x(),yield Object(l.a)(e||1e3);const a=d.a[d.b.clickSettingsCloseButton];return a&&(t=yield a({})),t})),E=()=>()=>Object(o.b)(void 0,void 0,void 0,(function*(){return yield x()})),C=()=>()=>{let e={actionCompleted:!1,status:"pinPage API not available"};try{if(!(Object(m.a)()&&window&&window.chrome&&window.chrome.appPinningPrivate&&window.chrome.appPinningPrivate.pinPage))return h.a.sendAppErrorEvent(Object.assign(Object.assign({},r.t),{message:"window.chrome.appPinningPrivate.pinPage not available"})),s.a.log(`Action completed: ${e.actionCompleted} status: ${e.status}`),e;const t="This attests that the user has agreed to pin this website";window.chrome.appPinningPrivate.pinPage(t,"https://microsoftnews.msn.com?ocid=msnewspintb","Microsoft News"),e={actionCompleted:!0,status:"Microsoftnews pinned to taskbar"}}catch(e){h.a.sendAppErrorEvent(Object.assign(Object.assign({},r.t),{message:"Exception executing window.chrome.appPinningPrivate.pinPage chromium API to pin Microsoftnews to taskbar",pb:{customMessage:"Exception: "+e}}))}return s.a.log(`Action completed: ${e.actionCompleted} status: ${e.status}`),e},O=e=>()=>Object(o.b)(void 0,void 0,void 0,(function*(){try{if(!(Object(m.a)()&&window&&window.chrome&&window.chrome.desktopWidgetPrivate))return h.a.sendAppErrorEvent(Object.assign(Object.assign({},r.Cb),{message:"window.chrome.desktopWidgetPrivate api not available"})),{actionCompleted:!1,status:"window.chrome.desktopWidgetPrivate api not available"};if(!window.chrome.desktopWidgetPrivate.launch)return h.a.sendAppErrorEvent(Object.assign(Object.assign({},r.kh),{message:"window.chrome.desktopWidgetPrivate.launch api not available"})),{actionCompleted:!1,status:"window.chrome.desktopWidgetPrivate.launch api not available"};const t=Object(l.d)(e);return window.chrome.desktopWidgetPrivate.launch(t,"COACHMARK"),window.chrome.desktopWidgetPrivate.enableAutoStart?(window.chrome.desktopWidgetPrivate.enableAutoStart(t,"COACHMARK"),{actionCompleted:!0,status:"Launched web widget and default to windows start."}):(h.a.sendAppErrorEvent(Object.assign(Object.assign({},r.jh),{message:"window.chrome.desktopWidgetPrivate.enableAutoStart api not available"})),{actionCompleted:!1,status:"window.chrome.desktopWidgetPrivate.enableAutoStart api not available"})}catch(e){return h.a.sendAppErrorEvent(Object.assign(Object.assign({},r.jc),{message:"Exception launching web widget and defaulting to windows start",pb:{customMessage:"Error: "+JSON.stringify(e)}})),{actionCompleted:!1,status:"Exception executing launchAndDefaultWebWidget() CTA"}}}));function x(){return Object(o.b)(this,void 0,void 0,(function*(){let e;const t=d.a[d.b.clickSettingsInformationalButton];return t&&(e=yield t({})),s.a.log(`Action completed: ${e.actionCompleted} status: ${e.status}`),e}))}function y(){return Object(o.b)(this,void 0,void 0,(function*(){let e;const t=d.a[d.b.clickSettingsButton];return t&&(e=yield t({})),s.a.log(`Action completed: ${e.actionCompleted} status: ${e.status}`),e}))}},SavL:function(e,t,a){"use strict";t.a={$schema:"http://json-schema.org/schema#",title:"Typography",description:"A typography component's schema definition.",type:"object",id:"@microsoft/fast-components-react-msft/typography",formPluginId:"@microsoft/fast-components-react-msft/typography",properties:{tag:{title:"HTML tag",type:"string",enum:["caption","h1","h2","h3","h4","h5","h6","p","span","figcaption"]},size:{title:"Type size",type:"number",enum:[1,2,3,4,5,6,7,8,9]}},reactProperties:{children:{title:"Children",type:"children",formPluginId:"@microsoft/fast-components-react-msft/typography/children",defaults:["text"],examples:["Lorem ipsum sit amet"]}},required:["children"]}},"W3b/":function(e,t,a){"use strict";a.r(t),a.d(t,"Coachmark",(function(){return se})),a.d(t,"CoachmarkActions",(function(){return H.a})),a.d(t,"CoachmarkInspector",(function(){return K})),a.d(t,"CoachmarkConnector",(function(){return re})),a.d(t,"CoachmarkReducer",(function(){return Q})),a.d(t,"CoachmarkReduxSubspaceName",(function(){return _})),a.d(t,"ToolingInfo",(function(){return de}));var n=a("D57K"),i=a("HxRh"),o=a("5mwN"),r=a("rcIs"),c=a("VZ41");var s=a("3ZGc"),d=a("rRWH"),l=a("1I/+"),h=a("ax+D"),m=a("Am8i"),p=a("FPTP"),u=a("y2Il"),g=a("SP+O"),b=a("MZhw"),k=a("objN"),f=a("mDtb"),v=a("LD6M"),E=a("aP31"),C=a("9CwC"),O=a("X9F+"),x=a("qibw"),y=a("0fst");var w=a("Gy7L"),T=a("kpPY"),j=a("gQ7Y"),I=a("ERkP"),P=a.n(I),B=a("7nmT"),M=a.n(B),A=a("tMmC"),S=a("Gil3"),D=a("0PLU"),L=a("keKk"),$=a("u5KZ");const N=(e,t)=>{switch(e.ctaType){case V.launchAndDefaultWebWidget:return()=>Object(n.b)(void 0,void 0,void 0,(function*(){z(t.hideCoachmark);const e=Object(S.d)(t.currentLayout);e&&e()}));case V.openAddDialog:return W(t);case V.pinMsnews:return()=>Object(n.b)(void 0,void 0,void 0,(function*(){z(t.hideCoachmark);const e=Object(S.g)();e&&e()}));case V.tryInformationalMode:return()=>Object(n.b)(void 0,void 0,void 0,(function*(){z(t.hideCoachmark);const e=Object(S.h)(t.delayInMs);e&&e()}));case V.tryInformationalModeProg:return()=>Object(n.b)(void 0,void 0,void 0,(function*(){z(t.hideCoachmark);const e=Object(S.j)(t.delayInMs);e&&e()}));case V.tryInformationalModeDirect:return()=>Object(n.b)(void 0,void 0,void 0,(function*(){z(t.hideCoachmark);const e=Object(S.i)();e&&e()}));case V.tryVoiceSearch:return()=>Object(n.b)(void 0,void 0,void 0,(function*(){z(t.hideCoachmark);const e=Object(S.b)();e&&e()}));default:$.a.sendAppErrorEvent(Object.assign(Object.assign({},i.V.InvalidCTAType),{message:"CTA type is invalid or not found.",pb:Object.assign(Object.assign({},i.V.InvalidCTAType.pb),{customMessage:`CTA type: ${e.ctaType} is invalid `})}))}},W=e=>()=>Object(n.b)(void 0,void 0,void 0,(function*(){z(e.hideCoachmark);const t=e.delayInMs||2e3;let a;const n=D.a[D.b.clickAddTileButton];n&&(a=yield n({})),A.a.log(`Action completed: ${a.actionCompleted} status: ${a.status}`),yield Object(L.a)(t);const i=e.updateCoachmark;i&&i()}));function z(e){e&&e()}var V;!function(e){e.launchAndDefaultWebWidget="launchAndDefaultWebWidget",e.openAddDialog="openAddDialog",e.pinMsnews="pinMsnews",e.tryVoiceSearch="tryVoiceSearch",e.tryInformationalMode="tryInformationalMode",e.tryInformationalModeDirect="tryInformationalModeDirect",e.tryInformationalModeProg="tryInformationalModeProg"}(V||(V={}));var F=a("QHbP");class R extends o.a{constructor(e){super(e),this.handledProps=Object.assign(Object.assign({},o.b),{actionPauseInMs:void 0,addCoachmarkMessages:void 0,addCoachmarkToPage:void 0,bodyText:void 0,bodyTextSize:void 0,coachmarkPlaced:void 0,coachmarkSource:void 0,contentModuleExperienceName:void 0,creativeId:void 0,ctaList:void 0,currentLayout:void 0,currentMessageIndex:void 0,dismissButtonAriaLabelText:void 0,disablePointer:void 0,displayType:void 0,ecsFeatureFlags:void 0,eventUrl:void 0,hideCoachmark:void 0,isTmplStampingRequired:void 0,isEcsExperiment:void 0,leadImage:void 0,leadImageAltText:void 0,mainImage:void 0,mainImageAltText:void 0,managedClasses:void 0,name:void 0,nonTargetPlacement:void 0,placement:void 0,placementId:void 0,pointerPosition:void 0,removeCoachmarkFromPage:void 0,renderCoachmark:void 0,reportEvent:void 0,retrieveInitialEligibilityStateOfCampaign:void 0,rewardsInfo:void 0,rootTelemetryObject:void 0,tabIndex:void 0,targetElement:void 0,timeoutMilliseconds:void 0,timeoutTriggered:void 0,titleText:void 0,titleTextSize:void 0,trackAppErrorEvent:void 0,trackEvent:void 0,trackPartialImpressionEvent:void 0,updateCoachmark:void 0,updateTemplValue:void 0,zIndex:void 0}),this.currentPointerTopOffset=0,this.currentPointerLeftOffset=0,this.currentLangDir=document.dir,this.windowUpdateEventCallback=()=>{window.requestAnimationFrame(()=>{this.updateCoachmarkPosition(this.props.placement),this.updateCloseButtonPosition()})},this.windowClickEventCallback=e=>{if(this.coachmarkElement&&this.coachmarkElement.current&&this.coachmarkElement.current.getBoundingClientRect){const t=this.coachmarkElement.current.getBoundingClientRect();!(e.clientX&&e.clientY&&e.clientX>=t.left&&e.clientX<=t.right&&e.clientY>=t.top&&e.clientY<=t.bottom)&&this.props.addCoachmarkToPage&&(this.userInteractedWithCoachmark||(this.stampTMPLTag(`ClickedAwayFromCoachmark_${this.props.contentModuleExperienceName}:1`),this.sendTelemetryEvent("click_nonnav","ClickedAwayFromCoachmark_"+this.props.contentModuleExperienceName,this.coachmarkElement.current,"",m.a.Click,m.b.Hide)),this.props.hideCoachmark())}return e},this.closeCoachmark=(e,t,a,i,o)=>Object(n.b)(this,void 0,void 0,(function*(){o||this.sendTelemetryEvent("click_nonnav","Dismiss",e.currentTarget,"",a,i),this.props.coachmarkSource===r.e.Iris&&this.props.reportEvent(c.b.Action,this.props.eventUrl,t,this.props.creativeId,this.props.placementId),this.props.removeCoachmarkFromPage(),this.cleanup()})),this.keyDownHandler=e=>{e.keyCode===w.h&&this.closeCoachmark(e,c.a.Dismiss,m.a.Click,m.b.Hide)},this.lastElementKeyDownHandler=(e,t,a,n,i)=>{e.keyCode===w.m?e.shiftKey?(e.preventDefault(),M.a.findDOMNode(this.coachmarkCTAButtonElement.current).focus()):(e.preventDefault(),M.a.findDOMNode(this.coachmarkCloseElement.current).focus()):e.keyCode===w.g&&this.closeCoachmark(e,t,a,n,i)},this.closeButtonKeyDownHandler=(e,t,a,n)=>{if(e.keyCode===w.m&&this.props.ctaList)if(e.shiftKey){e.preventDefault();const t=this.coachmarkDismissButtonElement.current?this.coachmarkDismissButtonElement.current:this.coachmarkCTAButtonElement.current;M.a.findDOMNode(t).focus()}else e.preventDefault(),M.a.findDOMNode(this.coachmarkCTAButtonElement.current).focus();else e.keyCode===w.g&&this.closeCoachmark(e,t,a,n)},this.ctaButtonHandler=(e,t,a)=>{this.userInteractedWithCoachmark=!0;((e,t,a)=>{const{ctaType:o}=e;if(o)if(t){if(a)return()=>Object(n.b)(void 0,void 0,void 0,(function*(){t.coachmarkSource===r.e.Iris&&t.reportEvent(c.b.Action,t.eventUrl,t.irisAction,t.creativeId,t.placementId);const a=N(e,t);return a?yield a():null}));$.a.sendAppErrorEvent(Object.assign(Object.assign({},i.V.EventNotDefined),{message:"Event is not defined"}))}else $.a.sendAppErrorEvent(Object.assign(Object.assign({},i.V.CoachmarkStateNotDefined),{message:"Coachmark state is not defined"}));else $.a.sendAppErrorEvent(Object.assign(Object.assign({},i.V.CTATypeNotDefined),{message:"CTA type is not defined"}))})(e,{creativeId:this.props.creativeId,coachmarkSource:this.props.coachmarkSource,currentLayout:this.props.currentLayout,delayInMs:this.props.actionPauseInMs,eventUrl:this.props.eventUrl,hideCoachmark:this.props.hideCoachmark,irisAction:a,name:this.props.contentModuleExperienceName?this.props.contentModuleExperienceName:"COACHMARK",placementId:this.props.placementId,reportEvent:this.props.reportEvent,trackEvent:this.props.trackEvent,updateCoachmark:this.props.updateCoachmark},t)()},this.ctaButtonKeyDownHandler=(e,t,a)=>{if(t.keyCode===w.m)if(t.shiftKey)t.preventDefault(),M.a.findDOMNode(this.coachmarkCloseElement.current).focus();else{t.preventDefault();const e=this.coachmarkDismissButtonElement.current?this.coachmarkDismissButtonElement.current:this.coachmarkCloseElement.current;M.a.findDOMNode(e).focus()}else t.keyCode===w.g&&this.ctaButtonHandler(e,t,a)},this.coachmarkElement=P.a.createRef(),this.coachmarkCloseElement=P.a.createRef(),this.coachmarkPointerElement=P.a.createRef(),this.coachmarkCTAButtonElement=P.a.createRef(),this.coachmarkDismissButtonElement=P.a.createRef(),this.isCurrentlyVisible=!1}componentDidUpdate(){super.componentDidUpdate(),this.initCoachmark()}componentDidMount(){super.componentDidMount(),this.initCoachmark(),this.coachmarkCloseElement.current&&M.a.findDOMNode(this.coachmarkCloseElement.current).focus()}render(){if(super.render(),!this.props.addCoachmarkToPage)return this.cleanup(),P.a.createElement("div",{id:R.emptyCoachmarkPageId});const{coachmark_default:e,coachmark_title:t,coachmark_body:a,coachmark_content:n}=this.props.managedClasses;return this.coachmarkTelemetryObject=this.props.rootTelemetryObject?this.props.rootTelemetryObject.addOrUpdateChild({name:this.props.contentModuleExperienceName?this.props.contentModuleExperienceName:"Coachmark",content:{headline:this.props.contentModuleExperienceName?this.props.contentModuleExperienceName:"Coachmark",type:m.c.Coachmark}}):null,P.a.createElement("div",Object.assign({},this.unhandledProps(),{id:R.mainElementPageId,ref:this.coachmarkElement,className:e,"aria-hidden":!this.isCurrentlyVisible,tabIndex:this.props.tabIndex?this.props.tabIndex:-1,style:{width:this.getCoachmarkWidth(this.props.displayType),zIndex:this.props.zIndex}},this.coachmarkTelemetryObject.render(),{onKeyDown:this.keyDownHandler}),this.props.disablePointer?null:this.renderPointer(this.props.placement),P.a.createElement("div",null,this.renderMainImage(),P.a.createElement("div",{className:n},this.renderLeadImage(),P.a.createElement("div",{id:R.titleTextElementPageId,className:t},P.a.createElement(p.a,{size:this.props.titleTextSize?this.props.titleTextSize:R.titleTextSize},this.props.titleText)),P.a.createElement("div",{id:R.bodyTextElementPageId,className:a},P.a.createElement(p.a,{size:this.props.bodyTextSize?this.props.bodyTextSize:R.bodyTextSize},this.props.bodyText))),this.renderCTAButtons()),this.renderCloseButton())}renderLeadImage(){return this.props.leadImage?P.a.createElement("img",{src:this.props.leadImage,className:this.props.managedClasses.coachmark_leadImage,alt:this.props.leadImageAltText}):null}renderMainImage(){return this.props.mainImage?P.a.createElement("img",{alt:this.props.mainImageAltText,className:this.props.managedClasses.coachmark_mainImage,src:this.props.mainImage,style:{width:this.getImageWidth(this.props.displayType)}}):null}renderCTAButtons(){return this.props.ctaList?P.a.createElement("div",{className:this.props.managedClasses.coachmark_ctaButton_container},this.renderCTAButton(this.props.ctaList[0]),this.renderDismissButton(this.props.ctaList[1])):null}renderCTAButton(e){return e&&e.ctaText?P.a.createElement(j.default,Object.assign({},this.coachmarkTelemetryObject?this.coachmarkTelemetryObject.addOrUpdateChild({name:e.ctaText.replace(/\s/g,""),behavior:e.ctaBehavior?m.b[""+e.ctaBehavior]:m.b.View,content:{headline:e.ctaText.replace(/\s/g,""),type:m.c.Coachmark}}).render():null,{"aria-label":e.ctaText,title:e.ctaText,ref:this.coachmarkCTAButtonElement,className:this.props.managedClasses.coachmark_ctaButton,onClick:t=>this.ctaButtonHandler(e,t,c.a.Click),onKeyDown:t=>this.ctaButtonKeyDownHandler(e,t,c.a.Click)}),e.ctaText):null}renderDismissButton(e){return e&&e.ctaText?P.a.createElement(j.default,Object.assign({},this.coachmarkTelemetryObject?this.coachmarkTelemetryObject.addOrUpdateChild({name:e.ctaText.replace(/\s/g,""),behavior:e.ctaBehavior?m.b[""+e.ctaBehavior]:m.b.Close,content:{headline:e.ctaText.replace(/\s/g,""),type:m.c.Coachmark}}).render():null,{"aria-label":e.ctaText,title:e.ctaText,ref:this.coachmarkDismissButtonElement,className:this.props.managedClasses.coachmark_dismissButton,onClick:e=>this.closeCoachmark(e,c.a.Dismiss,m.a.Click,m.b.Hide,!0),onKeyDown:e=>this.lastElementKeyDownHandler(e,c.a.Dismiss,m.a.Click,m.b.Hide,!0)}),e.ctaText):null}renderCloseButton(){const{coachmark_close:e}=this.props.managedClasses;return P.a.createElement("div",Object.assign({},this.coachmarkTelemetryObject?this.coachmarkTelemetryObject.addOrUpdateChild({name:"Dismiss",behavior:m.b.Close,content:{headline:"Dismiss",type:m.c.Coachmark}}).render():null,{id:R.closeElementPageId,ref:this.coachmarkCloseElement,"aria-label":this.props.dismissButtonAriaLabelText,onClick:e=>this.closeCoachmark(e,c.a.Dismiss,m.a.Click,m.b.Close),onKeyDown:e=>this.closeButtonKeyDownHandler(e,c.a.Dismiss,m.a.Click,m.b.Close),tabIndex:0}),P.a.createElement("svg",{className:e},P.a.createElement("path",{d:"M12.708 12L17 16.292L16.292 17L12 12.708L7.70801 17L7 16.292L11.292 12L7 7.70801L7.70801 7L12 11.292L16.292 7L17 7.70801L12.708 12Z"})))}renderPointer(e){return"128000000002304969"==this.props.creativeId||"128000000002370389"==this.props.creativeId?null:P.a.createElement("svg",{id:R.pointerElementPageId,ref:this.coachmarkPointerElement,className:this.props.managedClasses.coachmark_ptr,height:this.props.placement===r.b.Left||this.props.placement===r.b.Right?R.pointerBaseSize:R.pointerExtendSize,width:this.props.placement===r.b.Left||this.props.placement===r.b.Right?R.pointerExtendSize:R.pointerBaseSize,style:{filter:this.getPointerDropShadow(e)}},P.a.createElement("polygon",{points:this.getPointerSVGPoints(e)}))}sendTelemetryEvent(e,t,a,n,i,o){this.props.trackEvent&&e&&a&&t&&this.props.trackEvent({type:e,target:a},a,n,t,i,o)}updateCloseButtonPosition(){const e=this.coachmarkElement&&null!=this.coachmarkElement.current,t=document.getElementById(R.closeElementPageId);e&&t&&(t.style.left=Object(s.a)(this.coachmarkElement.current.offsetWidth-24-4))}getPointerDropShadow(e){switch(e){case r.b.Above:return"drop-shadow(-1px 4px 1px rgba(0, 0, 0, 0.11))";case r.b.Below:return"drop-shadow(0px -1px 1px rgba(0, 0, 0, 0.11))";case r.b.Right:return this.currentLangDir===d.a.rtl?"drop-shadow(2.2px 1px 1px rgba(0, 0, 0, 0.11))":"drop-shadow(-1.5px 2px 1px rgba(0, 0, 0, 0.11))";case r.b.Left:return this.currentLangDir===d.a.rtl?"drop-shadow(-1.5px 2px 1px rgba(0, 0, 0, 0.11))":"drop-shadow(2.2px 1px 1px rgba(0, 0, 0, 0.11))";default:return null}}getPointerSVGPoints(e){switch(e){case r.b.Above:return"0,0 13,14 26,0";case r.b.Below:return"0,14 13,0 26,14";case r.b.Right:return"14,0 0,13 14,26";case r.b.Left:return"0,0 14,13 0,26";default:return null}}updatePointer(e,t){const a=this.coachmarkElement&&this.coachmarkElement.current?this.coachmarkElement.current:null,n=this.coachmarkElement&&this.coachmarkPointerElement.current?this.coachmarkPointerElement.current:null;if(!n||!a)return;let o=0,c=0;switch(e){case r.b.Above:o=a.offsetHeight-1;break;case r.b.Below:o=-14;break;case r.b.Right:c=-13;break;case r.b.Left:c=a.offsetWidth-2;break;default:return}if(e===r.b.Above||e===r.b.Below)switch(t){case r.c.Adjacent:c=16;break;case r.c.Center:c=a.offsetWidth/2-R.pointerBaseSize/2;break;case r.c.Opposite:c=a.offsetWidth-16-R.pointerBaseSize;break;default:return void this.trackAppErrorEvent(Object.assign(Object.assign({},i.V.GeneralError),{message:`Error rendering ${this.props.contentModuleExperienceName} coachmark pointer due to invalid pointer position value`,pb:Object.assign(Object.assign({},i.V.GeneralError.pb),{customMessage:`Invalid pointer position value for coachmark: ${this.props.contentModuleExperienceName} creativeId: ${this.props.creativeId} placementId: ${this.props.placementId}`})}))}else{if(e!==r.b.Right&&e!==r.b.Left)return;switch(t){case r.c.Adjacent:o=16;break;case r.c.Center:o=a.offsetHeight/2-R.pointerBaseSize/2;break;case r.c.Opposite:o=a.offsetHeight-16-R.pointerBaseSize;break;default:return void this.trackAppErrorEvent(Object.assign(Object.assign({},i.V.GeneralError),{message:`Error rendering ${this.props.contentModuleExperienceName} coachmark pointer due to invalid pointer position value`,pb:Object.assign(Object.assign({},i.V.GeneralError.pb),{customMessage:`Invalid pointer position value for coachmark: ${this.props.contentModuleExperienceName} creativeId: ${this.props.creativeId} placementId: ${this.props.placementId}`})}))}}this.currentPointerTopOffset=o,this.currentPointerLeftOffset=c,n.style.top=Object(s.a)(o),n.style[Object(d.b)("left","right",document.dir)]=Object(s.a)(c)}updateCoachmarkPosition(e){let t=0,a=0,n=0,o=0;const c=document.body.offsetWidth;if("128000000002304969"==this.props.creativeId||"128000000002370389"==this.props.creativeId){if(document.getElementById("museumCard")){const e=document.getElementById("museumCard").getBoundingClientRect(),t=e.right,a=e.top,n=this.coachmarkElement.current.getBoundingClientRect(),i=n.left,o=n.right;this.coachmarkElement.current.style.top=Object(s.a)(a-200),this.coachmarkElement.current.style.left=Object(s.a)(t-(o-i))}else this.coachmarkElement.current.style.top=Object(s.a)(50),this.coachmarkElement.current.style.left=Object(s.a)(50)}else if(this.targetElement&&this.targetElement.getBoundingClientRect&&this.coachmarkElement&&this.coachmarkElement.current&&this.coachmarkElement.current.style){const n=this.targetElement.getBoundingClientRect();switch(e){case r.b.Above:t=n.top-(this.coachmarkElement.current.offsetHeight+R.pointerExtendSize+R.spaceBetweenCoachmarkAndTargetElement),a=this.currentLangDir===d.a.ltr?n.left+n.width/2-(this.currentPointerLeftOffset+16):c-(n.left+n.width/2+this.currentPointerLeftOffset+16);break;case r.b.Below:t=n.top+(n.height+R.pointerExtendSize+R.spaceBetweenCoachmarkAndTargetElement),a=this.currentLangDir===d.a.ltr?n.left+n.width/2-(this.currentPointerLeftOffset+16):c-(n.left+n.width/2+this.currentPointerLeftOffset+16);break;case r.b.Right:t=n.top+n.height/2-(this.currentPointerTopOffset+R.pointerBaseSize/2),a=this.currentLangDir===d.a.ltr?n.left+n.height+R.pointerExtendSize+R.spaceBetweenCoachmarkAndTargetElement:c-(n.left-R.pointerExtendSize-R.spaceBetweenCoachmarkAndTargetElement);break;case r.b.Left:t=n.top+n.height/2-(this.currentPointerTopOffset+R.pointerBaseSize/2),a=this.currentLangDir===d.a.ltr?n.left-(this.coachmarkElement.current.offsetWidth+R.pointerExtendSize+R.spaceBetweenCoachmarkAndTargetElement):c-(n.right+this.coachmarkElement.current.offsetWidth+R.pointerExtendSize+R.spaceBetweenCoachmarkAndTargetElement);break;default:return void this.trackAppErrorEvent(Object.assign(Object.assign({},i.V.GeneralError),{message:`Error rendering ${this.props.contentModuleExperienceName} coachmark pointer due to invalid pointer position value`,pb:Object.assign(Object.assign({},i.V.GeneralError.pb),{customMessage:`Invalid pointer position value for coachmark: ${this.props.contentModuleExperienceName} creativeId: ${this.props.creativeId} placementId: ${this.props.placementId}`})}))}}if(this.props.nonTargetPlacement){const i=10,s=this.targetElement&&this.targetElement.getBoundingClientRect&&this.targetElement.getBoundingClientRect();this.props.nonTargetPlacement!==r.f.TopStart&&this.props.nonTargetPlacement!==r.f.BottomStart||(a=this.targetElement&&e===r.b.Right?(this.currentLangDir===d.a.ltr?s.right:c-s.left)+i:i),this.props.nonTargetPlacement!==r.f.TopEnd&&this.props.nonTargetPlacement!==r.f.BottomEnd||(o=this.targetElement&&e===r.b.Left?(this.currentLangDir===d.a.ltr?c-s.left:s.right)+i:i,a=0),this.props.nonTargetPlacement!==r.f.TopStart&&this.props.nonTargetPlacement!==r.f.TopEnd||e===r.b.Below||(t=i),this.props.nonTargetPlacement!==r.f.BottomStart&&this.props.nonTargetPlacement!==r.f.BottomEnd||(n=this.targetElement&&e===r.b.Above?Object(l.b)(this.props.requestContext.data.innerHeight,"innerHeight")-s.top:i,t=0)}this.coachmarkElement.current.style.top=0!==t?Object(s.a)(t):"auto",this.coachmarkElement.current.style.bottom=0!==n?Object(s.a)(n):"auto",this.coachmarkElement.current.style[Object(d.b)("left","right",this.currentLangDir)]=0!==a?Object(s.a)(a):"auto",this.coachmarkElement.current.style[Object(d.b)("right","left",this.currentLangDir)]=0!==o?Object(s.a)(o):"auto"}initCoachmark(){return Object(n.b)(this,void 0,void 0,(function*(){if(this.props.addCoachmarkToPage)if(this.targetElement=this.findTargetElement(),this.targetElement||"128000000002304969"==this.props.creativeId||"128000000002370389"==this.props.creativeId||this.props.nonTargetPlacement){this.userInteractedWithCoachmark=!1,this.props.disablePointer||this.updatePointer(this.props.placement,this.props.pointerPosition),this.updateCoachmarkPosition(this.props.placement),this.updateCloseButtonPosition();const e=this.coachmarkFitsInViewport();if(e)return this.props.removeCoachmarkFromPage(),void this.trackAppErrorEvent(Object.assign(Object.assign({},i.V.NotPlaceable),{message:`Coachmark: ${this.props.contentModuleExperienceName} not placeable on user screen`,pb:Object.assign(Object.assign({},i.V.NotPlaceable.pb),{customMessage:`Error rendering coachmark: ${this.props.contentModuleExperienceName} creativeId: ${this.props.creativeId} placementId: ${this.props.placementId}\n                        on user screen. ${e}`})}));if(window.addEventListener(R.windowEventResize,this.windowUpdateEventCallback,!1),window.addEventListener(R.windowEventScroll,this.windowUpdateEventCallback,!1),window.addEventListener(R.windowEventClick,this.windowClickEventCallback,!0),this.addAutoDismiss(),this.props.isTmplStampingRequired&&(this.stampTMPLTag(`userEligibleToSeeCoachmark_${this.props.contentModuleExperienceName}:1`),this.props.retrieveInitialEligibilityStateOfCampaign(this.props.creativeId)&&this.stampTMPLTag(`userEligibleToSeeCoachmark_${this.props.creativeId}:1`)),h.a.isNotNullOrUndefined(this.props.renderCoachmark)&&!this.props.renderCoachmark)return this.props.removeCoachmarkFromPage(),void this.stampTMPLTag(`coachmarkSuppressed_${this.props.contentModuleExperienceName}:1`);this.props.renderCoachmark&&this.props.isTmplStampingRequired&&this.stampTMPLTag(`coachmarkShown_${this.props.contentModuleExperienceName}:1`),this.props.coachmarkPlaced(this.props.contentModuleExperienceName,this.props.creativeId,this.props.placementId),this.props.trackPartialImpressionEvent&&"function"==typeof this.props.trackPartialImpressionEvent&&this.props.trackPartialImpressionEvent(this.coachmarkElement.current,!1,"partial",this.props.contentModuleExperienceName?this.props.contentModuleExperienceName:"coachmark_module_v2"),this.props.coachmarkSource===r.e.Iris&&this.props.reportEvent(c.b.Impression,this.props.eventUrl,void 0,this.props.creativeId,this.props.placementId)}else this.props.removeCoachmarkFromPage(),this.targetElement=null}))}stampTMPLTag(e){this.props.updateTemplValue&&"function"==typeof this.props.updateTemplValue?this.props.updateTemplValue(e):this.props.trackAppErrorEvent(Object.assign(Object.assign({},i.V.NotFoundComponent),{message:"TMPL function not found preventing stamp for coachmark: "+this.props.contentModuleExperienceName,pb:Object.assign(Object.assign({},i.V.NotFoundComponent.pb),{customMessage:`Error stamping TMPL tags due to undefined callback function\n                        Coachmark:  ${this.props.contentModuleExperienceName} creativeId: ${this.props.creativeId} placementId: ${this.props.placementId}`})}))}addAutoDismiss(){if(this.props.timeoutMilliseconds&&this.props.timeoutMilliseconds>0){const e=this.props.currentMessageIndex;window.setTimeout(()=>{this.props.addCoachmarkToPage&&(this.stampTMPLTag(`CoachmarkAutoDismissed_${this.props.contentModuleExperienceName}:1`),this.sendTelemetryEvent("click_nonnav","CoachmarkAutoDismissed_"+this.props.contentModuleExperienceName,this.coachmarkElement.current,"",m.a.Click,m.b.Hide),this.props.timeoutTriggered(e))},this.props.timeoutMilliseconds)}}findTargetElement(){const e=document.querySelector(Object(T.a)("[{0}='{1}']",R.targetElementAttributeName,this.props.targetElement));if(!e){const e=Object(F.a)(this.props.targetElement);if(e)return e}return e||this.trackAppErrorEvent(Object.assign(Object.assign({},i.V.GeneralError),{message:`Error rendering ${this.props.contentModuleExperienceName} coachmark due to absent target element: ${this.props.targetElement} on page.`,pb:Object.assign(Object.assign({},i.V.GeneralError.pb),{customMessage:`Coachmark: ${this.props.contentModuleExperienceName} not rendered on user screen due to absent target element: ${this.props.targetElement} on page\n                         creativeId: ${this.props.creativeId} placementId: ${this.props.placementId}`})})),e}coachmarkFitsInViewport(){if(!(window&&this.coachmarkElement&&this.coachmarkElement.current&&this.coachmarkElement.current.getBoundingClientRect))return window?"Coachmark element not found or not able to retrieve coachmark size and relative position to viewport":"Window object undefined";const e=this.coachmarkElement.current.getBoundingClientRect(),t=Object(l.b)(this.props.requestContext.data.innerWidth,"innerWidth"),a=`top: ${e.top} bottom: ${e.bottom} left: ${e.left} right: ${e.right}`;return e.top<0?"Too Far Above. Exceeds Page Top. "+a:e.left<0?"Too Far Left. Exceeds Page Side. "+a:e.bottom>window.innerHeight||e.bottom>document.documentElement.clientHeight?"Too Far Below. Exceeds Page Bottom. "+a+` innnerHeight: ${window.innerHeight} clientHeight: ${document.documentElement.clientHeight}`:e.right>t||e.right>document.documentElement.clientWidth?"Too Far Right. Exceeds Page Side. "+a+` width: ${t} clientWidth: ${document.documentElement.clientWidth}`:null}cleanup(){this.isCurrentlyVisible=!1,this.targetElement=null,window.removeEventListener(R.windowEventResize,this.windowUpdateEventCallback),window.removeEventListener(R.windowEventScroll,this.windowUpdateEventCallback),window.removeEventListener(R.windowEventClick,this.windowClickEventCallback),this.coachmarkElement&&this.coachmarkElement.current&&this.coachmarkElement.current.style&&(this.coachmarkElement.current.style.top="0",this.coachmarkElement.current.style.left="0")}trackAppErrorEvent(e){this.props.trackAppErrorEvent&&"function"==typeof this.props.trackAppErrorEvent&&this.props.trackAppErrorEvent(e)}getCoachmarkWidth(e){switch(r.d[e]){case r.d.Small:return"248px";case r.d.Medium:return"288px";case r.d.Large:return"368px";default:return"288px"}}getImageWidth(e){switch(r.d[e]){case r.d.Small:return"280px";case r.d.Medium:return"320px";case r.d.Large:return"400px";default:return"320px"}}}R.defaultProps={experienceName:"MsnCoachmark"},R.targetElementAttributeName="data-targetid",R.mainElementPageId="coachmark-v2",R.pointerElementPageId="coachmark-v2-ptr",R.titleTextElementPageId="coachmark-v2-titletxt",R.bodyTextElementPageId="coachmark-v2-bodytxt",R.closeElementPageId="coachmark-v2-close",R.emptyCoachmarkPageId="coachmark-v2-empty",R.titleTextSize=u.a._6,R.bodyTextSize=u.a._7,R.pointerBaseSize=26,R.pointerExtendSize=14,R.spaceBetweenCoachmarkAndTargetElement=2,R.windowEventResize="resize",R.windowEventScroll="scroll",R.windowEventClick="click";var U=a("05Au"),H=a("kLs4");const _="MsnCoachmark";class Q{reduce(e,t){if(!e)return{coachmarkMessageQueue:null,addCoachmarkToPage:!1,messageIndex:-1,contentModuleExperienceName:void 0};if(!t)return e;let a=null,n=!1;return n=U.a.handleAction(t,H.a.removeCoachmarkFromPage,()=>{a=Object.assign({},e),a.coachmarkMessageQueue=null,a.messageIndex=-1,a.addCoachmarkToPage=!1,a.contentModuleExperienceName=void 0}),n=n||U.a.handleAction(t,H.a.updateCoachmark,()=>{a=Object.assign({},e),a.messageIndex=a.messageIndex+1,a.addCoachmarkToPage=!0,a.contentModuleExperienceName=a.coachmarkMessageQueue[a.messageIndex].name}),n=n||U.a.handleAction(t,H.a.timeoutOccurred,t=>{t===e.messageIndex&&(a=Object.assign({},e),a.coachmarkMessageQueue=null,a.messageIndex=-1,a.addCoachmarkToPage=!1,a.contentModuleExperienceName=void 0)}),n=n||U.a.handleAction(t,H.a.addCoachmarkMessages,t=>{t&&t.length&&(e.coachmarkMessageQueue?"object"==typeof e.coachmarkMessageQueue&&e.coachmarkMessageQueue.length&&(a=Object.assign({},e),a.coachmarkMessageQueue.push(...t),(a.messageIndex<0||a.messageIndex>=a.coachmarkMessageQueue.length)&&(a.messageIndex=a.coachmarkMessageQueue.length-1)):(a=Object.assign({},e),a.coachmarkMessageQueue=t,a.messageIndex=0),a.contentModuleExperienceName=a.coachmarkMessageQueue[a.messageIndex].name,a.addCoachmarkToPage=!0)}),n=n||U.a.handleAction(t,H.a.hideCoachmark,()=>{a=Object.assign({},e),a.addCoachmarkToPage=!1}),a||e}}var K,G=a("+viU"),q=a("bZQK"),X=a("ypwz"),Z=a("s9+9");(K||(K={})).inspect=function(e){const{config:t,state:a,connectorArgs:n}=e;let i=null;return a.addCoachmarkToPage&&a.coachmarkMessageQueue&&a.messageIndex>=0&&a.coachmarkMessageQueue[a.messageIndex]&&(i=a.coachmarkMessageQueue[a.messageIndex]),{props:Object.assign(Object.assign(Object.assign({},i),n),{titleTextSize:t.titleTextSize,bodyTextSize:t.bodyTextSize,dismissButtonAriaLabelText:t.accessibility.ariaLabel.dismissButton,currentMessageIndex:a.messageIndex,addCoachmarkToPage:!!i,tabIndex:t.tabIndex,eventUrl:i&&i.eventUrl?i.eventUrl:void 0,rootTelemetryObject:n.telemetryObject,contentModuleExperienceName:a.contentModuleExperienceName?a.contentModuleExperienceName.replace(/\s/g,""):"coachmark_module_v2",requestContext:n.requestContext,renderCoachmark:i&&i.isEcsExperiment?n.isECSFeatureFlagsEnabled(i.ecsFeatureFlags):t.renderCoachmark,isTmplStampingRequired:t.isTmplStampingRequired}),missingChildren:[]}};var J=a("U6Xm"),Y=a("QnRU"),ee=a("ljWX"),te=a("9J8d"),ae=a("dTwT"),ne=a("rvYQ"),ie=a("WfnD"),oe=a("XLvf");class re extends ie.a{constructor(e,t,a,o,r,c,s){super(e,t,a,o,r,c,s),this.trackEventCallback=(e,t,a,n,i,o)=>{$.a&&$.a.sendActionEvent(t,i,o)},this.trackPartialImpressionCallback=(e,t,a,n)=>{$.a&&e&&$.a.observeElementTree(e)},this.trackAppErrorEventCallback=e=>{$.a&&$.a.sendAppErrorEvent(e)},this.reportEvent=(e,t,a,n,o)=>{this.coachmarkDataConnector?this.coachmarkDataConnector.reportEvent(e,t,a,n,o):this.trackAppErrorEventCallback(Object.assign(Object.assign({},i.V.CoachmarkDataConnectorUndefined),{message:"Error reporting iris telemetry due to undefined coachmark data connector.",pb:Object.assign(Object.assign({},i.V.CoachmarkDataConnectorUndefined.pb),{customMessage:`creativeId: ${n} placementId: ${o} irisAction: ${a} eventType: ${e} eventUrl: ${JSON.stringify(t)}`})}))},this.coachmarkPlaced=(e,t,a)=>Object(n.b)(this,void 0,void 0,(function*(){this.coachmarkDataConnector?J.a.updateCoachmarkVisibleStatus.getActionSender(this.coachmarkDataConnector).send(!0):this.trackAppErrorEventCallback(Object.assign(Object.assign({},i.V.CoachmarkDataConnectorUndefined),{message:`Error reporting coachmark: ${e} status due to undefined coachmark data connector.`,pb:Object.assign(Object.assign({},i.V.CoachmarkDataConnectorUndefined.pb),{customMessage:`coachmark: ${e} creativeId: ${t} placementId: ${a}`})}))})),this.retrieveInitialEligibilityStateOfCampaignCallback=e=>!!e&&!0===Object(ae.a)().getObject(e),this.isECSFeatureFlagsEnabled=e=>{if(!e||!this.configData)return!1;const t=e.split(",");for(const e in t)if(!this.configData[t[e]])return!1;return!0},this.removeCoachmarkFromPage=()=>H.a.removeCoachmarkFromPage.getActionSender(this).send(),this.updateCoachmark=()=>H.a.updateCoachmark.getActionSender(this).send(),this.timeoutTriggered=e=>H.a.timeoutOccurred.getActionSender(this).send(e),this.addCoachmarkMessages=e=>H.a.addCoachmarkMessages.getActionSender(this).send(e),this.hideCoachmark=()=>H.a.hideCoachmark.getActionSender(this).send(),ne.b&&ne.b.AppType&&ne.b.AppType===X.a.EdgeChromium&&(this.layoutDataConnector=te.a.getInstance().rootReducer.connector(Z.a.PageLayout))}onComponentConnect(e){return Object(n.b)(this,void 0,void 0,(function*(){yield ie.a.prototype.onComponentConnect.call(this,e),e&&this.initializeCallbacks(e),this.updateTemplValueCallback||(this.updateTemplValueCallback=e=>{$.a.addOrUpdateTmplString(e)});const t=this.getCurrentState();if(t){const e=this.config&&this.config.messageList&&this.config.messageList.length>0;t.addCoachmarkToPage=e,t.messageIndex=e?0:-1,t.coachmarkMessageQueue=e?this.config.messageList:null}te.a.getInstance().rootReducer.getDataConnector(Z.a.CoachmarkData).then(e=>Object(n.b)(this,void 0,void 0,(function*(){e?(this.coachmarkDataConnector=e,ne.b&&ne.b.AppType&&ne.b.AppType===X.a.EdgeChromium&&(this.configData=yield Y.a.getConfigData(),this.layoutDataConnector||(this.layoutDataConnector=te.a.getInstance().rootReducer.connector(Z.a.PageLayout))),J.a.addCoachmark.registerObserver(()=>{this.addCoachmarksToMessageQueue(e.getCurrentState().coachmarkMessages)}),e.getCoachmarks(ee.d.MSNNewsCoachmark).then(e=>{this.addCoachmarksToMessageQueue(r.a.extractMessages(e))})):this.trackAppErrorEventCallback(Object.assign(Object.assign({},i.V.CoachmarkDataConnectorUndefined),{message:"Coachmark data connector is undefined"}))}))),H.a.readyToAddCoachmark.getActionSender(this).send()}))}mapStateToProps(e,t){const a={config:this.config,state:e,connectorArgs:{removeCoachmarkFromPage:this.removeCoachmarkFromPage,updateCoachmark:this.updateCoachmark,timeoutTriggered:this.timeoutTriggered,addCoachmarkMessages:this.addCoachmarkMessages,hideCoachmark:this.hideCoachmark,retrieveInitialEligibilityStateOfCampaign:this.retrieveInitialEligibilityStateOfCampaignCallback,trackEvent:this.trackEventCallback,trackPartialImpressionEvent:this.trackPartialImpressionCallback,trackAppErrorEvent:this.trackAppErrorEventCallback,telemetryObject:this.telemetryObject,updateTemplValue:this.updateTemplValueCallback,reportEvent:this.reportEvent,coachmarkPlaced:this.coachmarkPlaced,requestContext:this.requestContext,configData:this.configData,currentLayout:this.getCurrentPageLayout(),isECSFeatureFlagsEnabled:this.isECSFeatureFlagsEnabled}},n=K.inspect(a).props;return Object.assign(Object.assign({},t),n)}addCoachmarksToMessageQueue(e){e&&e.length>0&&(this.removeCoachmarkFromPage(),this.addCoachmarkMessages(e))}initializeCallbacks(e){Object(oe.isFunction)(e.trackEventCallback)&&(this.trackEventCallback=e.trackEventCallback),Object(oe.isFunction)(e.trackPartialImpressionCallback)&&(this.trackPartialImpressionCallback=e.trackPartialImpressionCallback),Object(oe.isFunction)(e.trackAppErrorEventCallback)&&(this.trackAppErrorEventCallback=e.trackAppErrorEventCallback),Object(oe.isFunction)(e.updateTemplValueCallback)&&(this.updateTemplValueCallback=e.updateTemplValueCallback)}getCurrentPageLayout(){this.layoutDataConnector&&this.layoutDataConnector.getLayoutStateAsync().then(e=>e?e.currentLayout:void 0)}}var ce=a("qv6S");const se=Object(G.a)(e=>{const t=e&&e.direction?e.direction:x.a.ltr;return{coachmark_default:{color:g.c,"background-color":b.c,"border-radius":Object(s.a)(4),"box-shadow":"0 12.8px 28.8px rgba(0,0,0,.22), 0 2.4px 7.2px rgba(0,0,0,.18)",left:"0",outline:"none",padding:`${Object(s.a)(16)} ${Object(s.a)(16)} ${Object(s.a)(16)} ${Object(s.a)(16)}`,position:"fixed",top:"0","z-index":(y.a.Flyout+50).toString(),[k.D]:{background:"WindowText",color:k.a.text}},coachmark_title:Object.assign({"grid-column":"2","grid-row":"1","letter-spacing":"0.6px","margin-bottom":"8px","line-height":"20px","text-align":Object(d.b)("left","right",t)},Object(f.d)()),coachmark_body:{"grid-column":"2","grid-row":"2","text-align":Object(d.b)("left","right",t),"line-height":"20px"},coachmark_ptr:{position:"absolute",fill:b.c},coachmark_close:{position:"absolute",width:Object(s.a)(24),height:Object(s.a)(24),"border-radius":"2px","&:hover":{"background-color":v.b,cursor:"pointer"},fill:g.c,top:Object(s.a)(4),[Object(d.b)("right","left",e.direction)]:Object(s.a)(4)},coachmark_leadImage:{float:Object(d.b)("left","right",t),"grid-column":"1","margin-right":Object(d.b)("16px","0px",t),"margin-left":Object(d.b)("0px","16px",t),width:"50px"},coachmark_mainImage:{margin:"-16px -16px 0 -16px",padding:"0 0 12px 0"},coachmark_ctaButton_container:{display:"grid","grid-template-columns":"1fr 8px 1fr","margin-top":"16px"},coachmark_ctaButton:{"grid-column":"1",height:"32px",background:Object(E.c)(b.c)(e),margin:"0px 8px 0px 0px","&:hover":{background:E.b},"border-radius":"2px","font-family":"Segoe UI","font-size":"12px","line-height":"16px",color:C.a,"border-width":"inherit"},coachmark_dismissButton:{"grid-column":"3",height:"32px",background:Object(O.c)(b.c)(e),margin:"0px 0px 0px 0px","&:hover":{background:O.b},"border-radius":"2px",float:"right","font-family":"Segoe UI","font-size":"12px","line-height":"16px",color:g.c,"border-width":"inherit"},coachmark_content:{display:"grid","grid-template-columns":"max-content auto"}}})(R),de={reactComponent:se,experienceConfigSchema:q.CoachmarkConfigSchema,defaultMockState:{},mockState:[{key:"preview",value:{}}],mockConfig:ce.mockConfig,inspector:K.inspect}},bZQK:function(e,t){},kLs4:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a("G82u");class i{}i.removeCoachmarkFromPage=new n.a("RemoveCoachmark"),i.updateCoachmark=new n.a("UpdateCoachmark"),i.timeoutOccurred=new n.a("TimeoutCoachmark"),i.addCoachmarkMessages=new n.a("AddCoachmarkMessage"),i.hideCoachmark=new n.a("HideCoachmark"),i.readyToAddCoachmark=new n.a("readyToAddCoachmark")},qv6S:function(e,t){},rX1t:function(e,t,a){"use strict";a.r(t),a.d(t,"ToolingInfo",(function(){return he})),a.d(t,"CoachmarkWC",(function(){return Q})),a.d(t,"LeadImage",(function(){return X})),a.d(t,"mainImage",(function(){return Z})),a.d(t,"pointer",(function(){return J})),a.d(t,"headerImageOrPointer",(function(){return Y})),a.d(t,"ctaButton",(function(){return ee})),a.d(t,"dismissButton",(function(){return te})),a.d(t,"ctaButtons",(function(){return ae})),a.d(t,"CoachmarkContentTemplate",(function(){return ne})),a.d(t,"CoachmarkWCTemplate",(function(){return ie})),a.d(t,"CoachmarkWCStyles",(function(){return le}));var n=a("A03o"),i=a("C49W"),o=a("sydv"),r=a("X3C0"),c=a("wKWo"),s=(a("wAA9"),a("SavL"));const d=Object(r.a)(s.a,"reactProperties.children");Object(c.a)(d.required,"children");const l=(e,t,a)=>Object(i.e)(e,t,a,Object.assign({},Object(i.c)("size","Size","",[1,2,3,4,5,6,7,8,9])));var h=a("rcIs"),m=a("Zn5T");const p=Object(n.a)(m.a.coachmarkWC,"Coachmark Configuration",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Object(i.c)("tabIndex","Tab index","Override tab order")),Object(i.a)("messageList","Coachmark messages","List of coachmark messages",Object.assign({},Object(i.d)("Coachmark","Coachmark message",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Object(o.c)("titleText","Title text","The headline text on the coachmark")),Object(o.c)("bodyText","Body text","The body text on the coachmark")),Object(o.a)("placement","Placement","Where the coachmark should appear in relation to the target element",[h.b.Above,h.b.Below,h.b.Left,h.b.Right])),Object(o.a)("pointerPosition","Pointer position","Where the pointer should appear on the coachmark",[h.c.Adjacent,h.c.Center,h.c.Opposite])),Object(o.c)("targetElement","Target element","The element to attach the coachark to")),Object(i.c)("timeoutMilliseconds","Time out in ms","Number of miliseconds to show the coachmark before removing from the page")),Object(i.e)("eventUrl","Event url","The event url is used to report user event to iris",Object.assign(Object.assign({},Object(o.c)("impressionUrl","Impression url","The Iris impression event url. Used to alert Iris that an impression event has happened.")),Object(o.c)("actionUrl","Action url","The Iris action event url. Used to alert Iris that an action event has happened.")),["impressionUrl","actionUrl"])),Object(i.c)("zIndex","zIndex","Controllable zIndex number in case the defaults do not suffice for the targeting scenario")))))),Object(i.e)("accessibility","Accessibility","String properties to decorate the UX element for accessibility communication",Object.assign({},Object(i.e)("ariaLabel","AriaLabel","Object containing all the needed aria accessibility strings",Object.assign({},Object(o.c)("dismissButton","Dismiss Button","Description of the dismiss pointer")))))),l("titleTextSize","Title text Size","The size of the title")),l("bodyTextSize","Body text Size","The size of the body text")));var u=a("D57K"),g=a("U6Xm"),b=a("VZ41"),k=a("ljWX"),f=a("QnRU");var v;!function(e){e.closeButton="closeButton",e.ctaButton="ctaButton",e.cancelButton="cancelButton",e.coachmarkElement="coachmarkElement",e.coachmarkPointerElement="coachmarkPointerElement"}(v||(v={}));var E=a("s9+9"),C=a("Gy7L"),O=a("qibw"),x=a("Am8i");var y=a("u5KZ");function w(e){y.a.sendAppErrorEvent(e)}function T(e){y.a.addOrUpdateTmplString(e)}function j(e,t,a,n,i,o){y.a.sendActionEvent(t,i,o,a)}function I(e,t,a,n,i,o){e&&a&&t&&j(0,a,n,0,i,o)}var P=a("+Ht2"),B=a("C4Mh"),M=a("HxRh"),A=a("L1Sn"),S=a("ax+D"),D=a("IqCT"),L=a("tMmC"),$=a("Gil3"),N=a("0PLU"),W=a("keKk");const z=(e,t)=>{switch(e.ctaType){case R.launchAndDefaultWebWidget:return()=>Object(u.b)(void 0,void 0,void 0,(function*(){F(t.hideCoachmark);const e=Object($.d)(t.currentLayout);e&&e()}));case R.openAddDialog:return V(t);case R.pinMsnews:return()=>Object(u.b)(void 0,void 0,void 0,(function*(){F(t.hideCoachmark);const e=Object($.g)();e&&e()}));case R.tryInformationalMode:return()=>Object(u.b)(void 0,void 0,void 0,(function*(){F(t.hideCoachmark);const e=Object($.h)(t.delayInMs);e&&e()}));case R.tryInformationalModeProg:return()=>Object(u.b)(void 0,void 0,void 0,(function*(){F(t.hideCoachmark);const e=Object($.j)(t.delayInMs);e&&e()}));case R.tryInformationalModeDirect:return()=>Object(u.b)(void 0,void 0,void 0,(function*(){F(t.hideCoachmark);const e=Object($.i)();e&&e()}));case R.tryVoiceSearch:return()=>Object(u.b)(void 0,void 0,void 0,(function*(){F(t.hideCoachmark);const e=Object($.b)();e&&e()}));default:y.a.sendAppErrorEvent(Object.assign(Object.assign({},M.V.InvalidCTAType),{message:"CTA type is invalid or not found.",pb:Object.assign(Object.assign({},M.V.InvalidCTAType.pb),{customMessage:`CTA type: ${e.ctaType} is invalid `})}))}},V=e=>()=>Object(u.b)(void 0,void 0,void 0,(function*(){F(e.hideCoachmark);const t=e.delayInMs||2e3;let a;const n=N.a[N.b.clickAddTileButton];n&&(a=yield n({})),L.a.log(`Action completed: ${a.actionCompleted} status: ${a.status}`),yield Object(W.a)(t);const i=e.updateCoachmark;i&&i()}));function F(e){e&&e()}var R;!function(e){e.launchAndDefaultWebWidget="launchAndDefaultWebWidget",e.openAddDialog="openAddDialog",e.pinMsnews="pinMsnews",e.tryVoiceSearch="tryVoiceSearch",e.tryInformationalMode="tryInformationalMode",e.tryInformationalModeDirect="tryInformationalModeDirect",e.tryInformationalModeProg="tryInformationalModeProg"}(R||(R={}));var U=a("QHbP"),H=a("oePG"),_=a("3ZGc");class Q extends D.a{constructor(){super(...arguments),this.currentPointerTopOffset=0,this.currentPointerLeftOffset=0,this.currentLangDir=document.dir,this.windowUpdateEventCallback=()=>{window.requestAnimationFrame(()=>{this.updateCoachmarkPosition(this.placement)})},this.windowClickEventCallback=e=>{if(this.coachmarkElement&&this.coachmarkElement&&this.coachmarkElement.getBoundingClientRect){const t=this.coachmarkElement.getBoundingClientRect();!(e.clientX&&e.clientY&&e.clientX>=t.left&&e.clientX<=t.right&&e.clientY>=t.top&&e.clientY<=t.bottom)&&this.addCoachmarkToPage&&(this.userInteractedWithCoachmark||(T(`ClickedAwayFromCoachmark_${this.contentModuleExperienceName}:1`),I("click_nonnav","ClickedAwayFromCoachmark_"+this.contentModuleExperienceName,this.coachmarkElement,"",x.a.Click,x.b.Hide)),this.hideCoachmark())}return e},this.isECSFeatureFlagsEnabled=e=>{if(!e||!this.configData)return!1;const t=e.split(",");for(const e in t)if(!this.configData[t[e]])return!1;return!0},this.coachmarkPlaced=(e,t,a)=>Object(u.b)(this,void 0,void 0,(function*(){this.coachmarkDataConnector?g.a.updateCoachmarkVisibleStatus.getActionSender(this.coachmarkDataConnector).send(!0):w(Object.assign(Object.assign({},M.V.CoachmarkDataConnectorUndefined),{message:`Error reporting coachmark: ${e} status due to undefined coachmark data connector.`,pb:Object.assign(Object.assign({},M.V.CoachmarkDataConnectorUndefined.pb),{customMessage:`coachmark: ${e} creativeId: ${t} placementId: ${a}`})}))})),this.closeCoachmark=(e,t,a,n,i)=>Object(u.b)(this,void 0,void 0,(function*(){if(!i&&!e&&!e.currentTarget){const t=A.a.get(e.currentTarget);t.contract.overrideDestinationUrl=window&&window.location&&window.location.href,t.contract.behavior=n,I("click_nonnav","Dismiss",e.currentTarget,"ntp",a,n)}this.coachmarkSource===h.e.Iris&&this.reportEvent(b.b.Action,this.eventUrl,t,this.creativeId,this.placementId),this.removeCoachmarkFromPage(),this.cleanup()})),this.ctaButtonHandler=(e,t)=>{this.userInteractedWithCoachmark=!0,"click"==e.type&&(t=b.a.Click);const a={creativeId:this.creativeId,coachmarkSource:this.coachmarkSource,currentLayout:this.layoutOptions,delayInMs:1e3,eventUrl:this.eventUrl,hideCoachmark:this.hideCoachmark.bind(this),irisAction:t,name:this.contentModuleExperienceName?this.contentModuleExperienceName:"COACHMARK",placementId:this.placementId,reportEvent:this.reportEvent.bind(this),trackEvent:j,updateCoachmark:this.updateCoachmark};((e,t,a)=>{const{ctaType:n}=e;if(n)if(t){if(a)return()=>Object(u.b)(void 0,void 0,void 0,(function*(){t.coachmarkSource===h.e.Iris&&t.reportEvent(b.b.Action,t.eventUrl,t.irisAction,t.creativeId,t.placementId);const a=z(e,t);return a?yield a():null}));y.a.sendAppErrorEvent(Object.assign(Object.assign({},M.V.EventNotDefined),{message:"Event is not defined"}))}else y.a.sendAppErrorEvent(Object.assign(Object.assign({},M.V.CoachmarkStateNotDefined),{message:"Coachmark state is not defined"}));else y.a.sendAppErrorEvent(Object.assign(Object.assign({},M.V.CTATypeNotDefined),{message:"CTA type is not defined"}))})(this.ctaList[0],a,e)()},this.keyDownHandler=e=>{e.keyCode===C.h&&this.closeCoachmark(e,b.a.Dismiss,x.a.Click,x.b.Hide)},this.lastElementKeyDownHandler=e=>{e.keyCode===C.m?e.shiftKey?(e.preventDefault(),this.ctaButtonElement&&this.ctaButtonElement.focus()):(e.preventDefault(),this.closeButtonElement&&this.closeButtonElement.focus()):e.keyCode===C.g&&this.closeCoachmark(e,b.a.Dismiss,x.a.Click,x.b.Hide,!0)},this.closeButtonKeyDownHandler=e=>{if(e.keyCode===C.m&&this.ctaList)if(e.shiftKey){e.preventDefault();(this.cancelButtonElement?this.cancelButtonElement:this.ctaButtonElement).focus()}else e.preventDefault(),this.ctaButtonElement&&this.ctaButtonElement.focus();else e.keyCode===C.g&&this.closeCoachmark(e,b.a.Dismiss,x.a.Click,x.b.Close)}}experienceConnected(){return Object(u.b)(this,void 0,void 0,(function*(){const e=Object(P.b)(E.a.CoachmarkData);let t=null;this.coachmarkTelemetryObject=this.telemetryObject?this.telemetryObject.addOrUpdateChild({name:this.contentModuleExperienceName?this.contentModuleExperienceName:"Coachmark",content:{headline:this.contentModuleExperienceName?this.contentModuleExperienceName:"Coachmark",type:x.c.Coachmark}}):null,Object(B.c)(E.a.ChromiumPageSettings,e=>{this.layoutOptions=e.currentLayout}),e?(this.coachmarkDataConnector=e,Object(B.c)(E.a.CoachmarkData,e=>{if(e&&e.coachmarkMessages){if(t===e.coachmarkMessages)return;t=e.coachmarkMessages,this.addCoachmarksToMessageQueue(e.coachmarkMessages)}}),e.getCoachmarks(k.d.MSNNewsCoachmark).then(e=>{this.addCoachmarksToMessageQueue(h.a.extractMessages(e))}),this.configData=yield f.a.getConfigData()):w(Object.assign(Object.assign({},M.V.CoachmarkDataConnectorUndefined),{message:"Coachmark data connector is undefined"}))}))}shadowDomPopulated(){this.closeButtonElement=this.shadowRoot.getElementById(v.closeButton),this.cancelButtonElement=this.shadowRoot.getElementById(v.cancelButton),this.ctaButtonElement=this.shadowRoot.getElementById(v.ctaButton),this.coachmarkElement=this.shadowRoot.getElementById(v.coachmarkElement),this.coachmarkPointerElement=this.shadowRoot.getElementById(v.coachmarkPointerElement),this.addCoachmarkToPage&&this.initCoachmark()}getExperienceType(){return m.a.coachmarkWC}addCoachmarksToMessageQueue(e){e&&e.length>0&&(this.removeCoachmarkFromPage(),this.addCoachmarkMessages(e))}addCoachmarkMessages(e){e&&e.length&&(this.coachmarkMessageQueue?"object"==typeof this.coachmarkMessageQueue&&this.coachmarkMessageQueue.length&&(this.coachmarkMessageQueue.push(...e),(this.messageIndex<0||this.messageIndex>=this.coachmarkMessageQueue.length)&&(this.messageIndex=this.coachmarkMessageQueue.length-1)):(this.coachmarkMessageQueue=e,this.messageIndex=0),this.addCoachmarkToPage=!0,this.contentModuleExperienceName=this.coachmarkMessageQueue[this.messageIndex].name,this.updateCoachmarkProperty())}timeoutTriggered(e){e===this.messageIndex&&this.removeCoachmarkFromPage()}updateCoachmark(){this.messageIndex=this.messageIndex+1,this.addCoachmarkToPage=!0,this.contentModuleExperienceName=this.coachmarkMessageQueue[this.messageIndex].name}removeCoachmarkFromPage(){this.coachmarkMessageQueue=null,this.messageIndex=-1,this.addCoachmarkToPage=!this.addCoachmarkToPage,this.coachmarkElement&&this.coachmarkElement.remove(),this.contentModuleExperienceName=void 0}hideCoachmark(){this.addCoachmarkToPage=!1}cleanup(){this.targetElement=null,window.removeEventListener("resize",this.windowUpdateEventCallback),window.removeEventListener("scroll",this.windowUpdateEventCallback),window.removeEventListener("click",this.windowClickEventCallback),this.coachmarkElement&&this.coachmarkElement.style&&(this.coachmarkElement.style.top="0",this.coachmarkElement.style.left="0")}updateCoachmarkProperty(){let e=null;this.addCoachmarkToPage&&this.coachmarkMessageQueue&&this.messageIndex>=0&&this.coachmarkMessageQueue[this.messageIndex]&&(e=this.coachmarkMessageQueue[this.messageIndex]),this.currentMessageIndex=this.messageIndex,this.addCoachmarkToPage=!!e,this.eventUrl=e&&e.eventUrl?e.eventUrl:void 0,this.contentModuleExperienceName=this.contentModuleExperienceName?this.contentModuleExperienceName.replace(/\s/g,""):"coachmark_module_v2",this.renderCoachmark=e&&e.isEcsExperiment?this.isECSFeatureFlagsEnabled(e.ecsFeatureFlags):this.config.renderCoachmark,this.isTmplStampingRequired=this.config.isTmplStampingRequired,this.renderCoachmark&&(this.actionPauseInMs=e.actionPauseInMs,this.bodyText=e.bodyText?e.bodyText:null,this.ctaList=e.ctaList,this.coachmarkSource=e.coachmarkSource,this.coachmarkZIndex=e.zIndex,this.creativeId=e.creativeId,this.disablePointer=e.disablePointer,this.displayType=e.displayType,this.coachmarkWidth=function(e){switch(h.d[e]){case h.d.Small:return"280px";case h.d.Medium:return"320px";case h.d.Large:return"400px";default:return"280px"}}(this.displayType),this.ecsFeatureFlags=e.ecsFeatureFlags,this.eventUrl=e.eventUrl,this.isEcsExperiment=e.isEcsExperiment,this.leadImage=e.leadImage,this.leadImageAltText=e.leadImageAltText,this.mainImage=e.mainImage,this.mainImageAltText=e.mainImageAltText,this.name=e.name,this.nonTargetPlacement=e.nonTargetPlacement,this.placement=e.placement,this.placementId=e.placementId,this.pointerPosition=e.pointerPosition,this.rewardsInfo=e.rewardsInfo,this.targetElementID=e.targetElement,this.timeoutMilliseconds=e.timeoutMilliseconds,this.titleText=e.titleText?e.titleText:null,this.pointerDropShadow=function(e){switch(e){case h.b.Above:return"drop-shadow(-1px 4px 1px rgba(0, 0, 0, 0.11))";case h.b.Below:return"drop-shadow(0px -1px 1px rgba(0, 0, 0, 0.11))";case h.b.Right:return document.dir===O.a.rtl?"drop-shadow(2.2px 1px 1px rgba(0, 0, 0, 0.11))":"drop-shadow(-1.5px 2px 1px rgba(0, 0, 0, 0.11))";case h.b.Left:return"drop-shadow(2.2px 1px 1px rgba(0, 0, 0, 0.11))";default:return null}}(this.placement),this.pointerPoints=function(e){switch(e){case h.b.Above:return"0,0 13,14 26,0";case h.b.Below:return"0,14 13,0 26,14";case h.b.Right:return"14,0 0,13 14,26";case h.b.Left:return"0,0 14,13 0,26";default:return null}}(this.placement),this.mainImageWidth=function(e){switch(h.d[e]){case h.d.Small:return"280px";case h.d.Medium:return"320px";case h.d.Large:return"400px";default:return"320px"}}(this.displayType),this.disablePointer||(this.showPointer=!0),this.ctaList&&(this.ctaList[0]&&(this.ctaButtonOneText=this.ctaList[0].ctaText?this.ctaList[0].ctaText:null,this.ctaButtonOneTelemetryTag=this.populateTelemetryTags(this.ctaList[0].ctaText,this.ctaList[0].ctaBehavior,x.b.View)),this.ctaList[1]&&(this.ctaButtonTwoText=this.ctaList[1].ctaText?this.ctaList[1].ctaText:null,this.ctaButtonTwoTelemetryTag=this.populateTelemetryTags(this.ctaList[1].ctaText,this.ctaList[1].ctaBehavior,x.b.Close))),this.cancelButtonTelemetryTag=this.cancelTelemetryTag())}populateTelemetryTags(e,t,a){return Object.assign({},this.coachmarkTelemetryObject?this.coachmarkTelemetryObject.addOrUpdateChild({name:e.replace(/\s/g,""),behavior:t?x.b[""+t]:a,content:{headline:e.replace(/\s/g,""),type:x.c.Coachmark}}):null)}cancelTelemetryTag(){return Object.assign({},this.coachmarkTelemetryObject?this.coachmarkTelemetryObject.addOrUpdateChild({name:"Dismiss",behavior:x.b.Close,content:{headline:"Dismiss",type:x.c.Coachmark}}):null)}addAutoDismiss(){if(this.timeoutMilliseconds>0){const e=this.currentMessageIndex;window.setTimeout(()=>{this.addCoachmarkToPage&&(this.addCoachmarkToPage=!this.addCoachmarkToPage,T(`CoachmarkAutoDismissed_${this.contentModuleExperienceName}:1`),I("click_nonnav","CoachmarkAutoDismissed_"+this.contentModuleExperienceName,this.coachmarkElement,"",x.a.Click,x.b.Hide),this.timeoutTriggered(e))},this.timeoutMilliseconds)}}findTargetElement(){const e=Object(U.a)(this.targetElementID);return e||w(Object.assign(Object.assign({},M.V.GeneralError),{message:`Error rendering ${this.contentModuleExperienceName} coachmark due to absent target element: ${this.targetElement} on page.`,pb:Object.assign(Object.assign({},M.V.GeneralError.pb),{customMessage:`Coachmark: ${this.contentModuleExperienceName} not rendered on user screen due to absent target element: ${this.targetElement} on page\n                         creativeId: ${this.creativeId} placementId: ${this.placementId}`})})),e}updatePointer(e,t){const a=this.coachmarkElement&&this.coachmarkElement?this.coachmarkElement:null,n=this.coachmarkElement&&this.coachmarkPointerElement?this.coachmarkPointerElement:null;if(!n||!a)return;let i=0,o=0;switch(e){case h.b.Above:i=a.offsetHeight-1;break;case h.b.Below:i=-14;break;case h.b.Right:o=-13;break;case h.b.Left:o=a.offsetWidth-2;break;default:return}if(e===h.b.Above||e===h.b.Below)switch(t){case h.c.Adjacent:o=16;break;case h.c.Center:o=a.offsetWidth/2-13;break;case h.c.Opposite:o=a.offsetWidth-16-26;break;default:return void w(Object.assign(Object.assign({},M.V.GeneralError),{message:`Error rendering ${this.contentModuleExperienceName} coachmark pointer due to invalid pointer position value`,pb:Object.assign(Object.assign({},M.V.GeneralError.pb),{customMessage:`Invalid pointer position value for coachmark: ${this.contentModuleExperienceName} creativeId: ${this.creativeId} placementId: ${this.placementId}`})}))}else{if(e!==h.b.Right&&e!==h.b.Left)return;switch(t){case h.c.Adjacent:i=16;break;case h.c.Center:i=a.offsetHeight/2-13;break;case h.c.Opposite:i=a.offsetHeight-16-26;break;default:return void w(Object.assign(Object.assign({},M.V.GeneralError),{message:`Error rendering ${this.contentModuleExperienceName} coachmark pointer due to invalid pointer position value`,pb:Object.assign(Object.assign({},M.V.GeneralError.pb),{customMessage:`Invalid pointer position value for coachmark: ${this.contentModuleExperienceName} creativeId: ${this.creativeId} placementId: ${this.placementId}`})}))}}this.currentPointerTopOffset=i,this.currentPointerLeftOffset=o;const r=n;r.style.top=Object(_.a)(i);const c=Object(_.a)(o);this.currentLangDir===O.a.ltr?r.style.left=c:r.style.right=c}initCoachmark(){return Object(u.b)(this,void 0,void 0,(function*(){var e;if(this.addCoachmarkToPage)if(this.targetElement=this.findTargetElement(),this.targetElement||"128000000002304969"==this.creativeId||"128000000002370389"==this.creativeId||this.nonTargetPlacement){this.userInteractedWithCoachmark=!1,this.disablePointer||this.updatePointer(this.placement,this.pointerPosition),this.updateCoachmarkPosition(this.placement);const t=this.coachmarkFitsInViewport();if(t)return this.removeCoachmarkFromPage(),void w(Object.assign(Object.assign({},M.V.NotPlaceable),{message:`Coachmark: ${this.contentModuleExperienceName} not placeable on user screen`,pb:Object.assign(Object.assign({},M.V.NotPlaceable.pb),{customMessage:`Error rendering coachmark: ${this.contentModuleExperienceName} creativeId: ${this.creativeId} placementId: ${this.placementId}\n                        on user screen. ${t}`})}));if(addEventListener("scroll",this.windowUpdateEventCallback,!1),addEventListener("resize",this.windowUpdateEventCallback,!1),addEventListener("click",this.windowClickEventCallback,!0),this.addAutoDismiss(),this.isTmplStampingRequired&&T(`userEligibleToSeeCoachmark_${this.contentModuleExperienceName}:1`),S.a.isNotNullOrUndefined(this.renderCoachmark)&&!this.renderCoachmark)return this.removeCoachmarkFromPage(),void T(`coachmarkSuppressed_${this.contentModuleExperienceName}:1`);this.renderCoachmark&&this.isTmplStampingRequired&&T(`coachmarkShown_${this.contentModuleExperienceName}:1`),this.coachmarkPlaced(this.contentModuleExperienceName,this.creativeId,this.placementId),e=this.coachmarkElement,y.a&&e&&y.a.observeElementTree(e),this.coachmarkSource===h.e.Iris&&this.reportEvent(b.b.Impression,this.eventUrl,void 0,this.creativeId,this.placementId)}else this.removeCoachmarkFromPage(),this.targetElement=null}))}reportEvent(e,t,a,n,i){this.coachmarkDataConnector?this.coachmarkDataConnector.reportEvent(e,t,a,n,i):w(Object.assign(Object.assign({},M.V.CoachmarkDataConnectorUndefined),{message:"Error reporting iris telemetry due to undefined coachmark data connector.",pb:Object.assign(Object.assign({},M.V.CoachmarkDataConnectorUndefined.pb),{customMessage:`creativeId: ${n} placementId: ${i} irisAction: ${a} eventType: ${e} eventUrl: ${JSON.stringify(t)}`})}))}coachmarkFitsInViewport(){if(!(window&&this.coachmarkElement&&this.coachmarkElement&&this.coachmarkElement.getBoundingClientRect))return window?"Coachmark element not found or not able to retrieve coachmark size and relative position to viewport":"Window object undefined";const e=this.coachmarkElement.getBoundingClientRect(),t=`top: ${e.top} bottom: ${e.bottom} left: ${e.left} right: ${e.right}`;return e.top<0?"Too Far Above. Exceeds Page Top. "+t:e.left<0?"Too Far Left. Exceeds Page Side. "+t:e.bottom>window.innerHeight||e.bottom>document.documentElement.clientHeight?"Too Far Below. Exceeds Page Bottom. "+t+` innnerHeight: ${window.innerHeight} clientHeight: ${document.documentElement.clientHeight}`:e.right>1903||e.right>document.documentElement.clientWidth?"Too Far Right. Exceeds Page Side. "+t+" width: 1903 clientWidth: "+document.documentElement.clientWidth:null}updateCloseButtonPosition(){this.coachmarkElement&&null!=this.coachmarkElement&&this.closeButtonElement&&(this.closeButtonElement.style.left=Object(_.a)(this.coachmarkElement.offsetWidth))}updateCoachmarkPosition(e){let t=0,a=0,n=0,i=0;const o=document.body.offsetWidth;if("128000000002304969"==this.creativeId||"128000000002370389"==this.creativeId){if(document.getElementById("museumCard")){const e=document.getElementById("museumCard").getBoundingClientRect(),t=e.right,a=e.top,n=this.coachmarkElement.getBoundingClientRect(),i=n.left,o=n.right;this.coachmarkElement.style.top=Object(_.a)(a-200),this.coachmarkElement.style.left=Object(_.a)(t-(o-i))}else this.coachmarkElement.style.top=Object(_.a)(50),this.coachmarkElement.style.left=Object(_.a)(50)}else if(this.targetElement&&this.targetElement.getBoundingClientRect&&this.coachmarkElement&&this.coachmarkElement.style){const n=this.targetElement.getBoundingClientRect();switch(e){case h.b.Above:t=n.top-(this.coachmarkElement.offsetHeight+14+2),a=this.currentLangDir===O.a.ltr?n.left+n.width/2-(this.currentPointerLeftOffset+16):o-(n.left+n.width/2+this.currentPointerLeftOffset+16);break;case h.b.Below:t=n.top+(n.height+14+2),a=this.currentLangDir===O.a.ltr?n.left+n.width/2-(this.currentPointerLeftOffset+16):o-(n.left+n.width/2+this.currentPointerLeftOffset+16);break;case h.b.Right:t=n.top+n.height/2-(this.currentPointerTopOffset+13),a=this.currentLangDir===O.a.ltr?n.left+n.height+14+2:o-(n.left-14-2);break;case h.b.Left:t=n.top+n.height/2-(this.currentPointerTopOffset+13),a=this.currentLangDir===O.a.ltr?n.left-(this.coachmarkElement.offsetWidth+14+2):o-(n.right+this.coachmarkElement.offsetWidth+14+2);break;default:return void w(Object.assign(Object.assign({},M.V.GeneralError),{message:`Error rendering ${this.contentModuleExperienceName} coachmark pointer due to invalid pointer position value`,pb:Object.assign(Object.assign({},M.V.GeneralError.pb),{customMessage:`Invalid pointer position value for coachmark: ${this.contentModuleExperienceName} creativeId: ${this.creativeId} placementId: ${this.placementId}`})}))}}if(this.nonTargetPlacement){const r=10,c=this.targetElement&&this.targetElement.getBoundingClientRect&&this.targetElement.getBoundingClientRect();this.nonTargetPlacement!==h.f.TopStart&&this.nonTargetPlacement!==h.f.BottomStart||(a=this.targetElement&&e===h.b.Right?(this.currentLangDir===O.a.ltr?c.right:o-c.left)+r:r),this.nonTargetPlacement!==h.f.TopEnd&&this.nonTargetPlacement!==h.f.BottomEnd||(i=this.targetElement&&e===h.b.Left?(this.currentLangDir===O.a.ltr?o-c.left:c.right)+r:r,a=0),this.nonTargetPlacement!==h.f.TopStart&&this.nonTargetPlacement!==h.f.TopEnd||e===h.b.Below||(t=r),this.nonTargetPlacement!==h.f.BottomStart&&this.nonTargetPlacement!==h.f.BottomEnd||(n=r,t=0)}this.coachmarkElement&&(this.coachmarkElement.style.top=0!==t?Object(_.a)(t):"auto",this.coachmarkElement.style.bottom=0!==n?Object(_.a)(n):"auto",this.coachmarkElement.style.left=0!==a?Object(_.a)(a):"auto",this.coachmarkElement.style.right=0!==i?Object(_.a)(i):"auto")}ctaButtonKeyDownHandler(e){if(e.keyCode===C.m)if(e.shiftKey)e.preventDefault(),this.closeButtonElement&&this.closeButtonElement.focus();else{e.preventDefault();(this.cancelButtonElement?this.cancelButtonElement:this.closeButtonElement).focus()}else e.keyCode===C.g&&this.ctaButtonHandler(e,b.a.Click)}}Object(u.c)([H.d],Q.prototype,"titleText",void 0),Object(u.c)([H.d],Q.prototype,"coachmarkWidth",void 0),Object(u.c)([H.d],Q.prototype,"bodyText",void 0),Object(u.c)([H.d],Q.prototype,"disablePointer",void 0),Object(u.c)([H.d],Q.prototype,"showPointer",void 0),Object(u.c)([H.d],Q.prototype,"leadImage",void 0),Object(u.c)([H.d],Q.prototype,"leadImageAltText",void 0),Object(u.c)([H.d],Q.prototype,"mainImage",void 0),Object(u.c)([H.d],Q.prototype,"mainImageAltText",void 0),Object(u.c)([H.d],Q.prototype,"ctaButtonTwoText",void 0),Object(u.c)([H.d],Q.prototype,"ctaButtonOneText",void 0),Object(u.c)([H.d],Q.prototype,"cancelText",void 0),Object(u.c)([H.d],Q.prototype,"addCoachmarkToPage",void 0),Object(u.c)([H.d],Q.prototype,"coachmarkZIndex",void 0),Object(u.c)([H.d],Q.prototype,"ctaButtonOneTelemetryTag",void 0),Object(u.c)([H.d],Q.prototype,"ctaButtonTwoTelemetryTag",void 0),Object(u.c)([H.d],Q.prototype,"cancelButtonTelemetryTag",void 0),Object(u.c)([H.d],Q.prototype,"coachmarkTelemetryObject",void 0),Object(u.c)([H.d],Q.prototype,"pointerDropShadow",void 0),Object(u.c)([H.d],Q.prototype,"pointerPoints",void 0),Object(u.c)([H.d],Q.prototype,"mainImageWidth",void 0),Object(u.c)([H.d],Q.prototype,"renderCoachmark",void 0);var K=a("6BDD"),G=a("6vBc"),q=a("eUhr");const X=K.b`
    <div class="heading-padding">
        <img src=${e=>e.leadImage} alt=${e=>e.leadImageAltText} class="coachmark-leadImage" />
    </div>
`,Z=K.b`
    <img src=${e=>e.mainImage} style= width:${e=>e.mainImageWidth} alt=${e=>e.mainImageAltText} class="coachmark-mainImage" />
`,J=K.b`
    <svg class="coachmark_ptr" id="coachmarkPointerElement" height="14" width="26" style= filter:${e=>e.pointerDropShadow}>
        <polygon points=${e=>e.pointerPoints}></polygon>
    </svg>
`,Y=K.b`
       ${Object(G.a)(e=>e.showPointer,J)}
        ${Object(G.a)(e=>e.mainImage,Z)}
`,ee=K.b`
    <fluent-button
            id="ctaButton"
            appearance="accent"
            tabindex="0"
            title=${e=>e.ctaButtonOneText}
            aria-label=${e=>e.ctaButtonOneText}
            @click=${(e,t)=>e.ctaButtonHandler(t.event)}
            @keydown=${(e,t)=>e.ctaButtonKeyDownHandler(t.event)}
            ${Object(q.b)(e=>e.ctaButtonOneTelemetryTag)}
        >
            ${e=>e.ctaButtonOneText}
        </fluent-button>
`,te=K.b`
    <fluent-button
                id="cancelButton"
                appearance="neutral"
                tabindex="0"
                title=${e=>e.ctaButtonTwoText}
                aria-label=${e=>e.ctaButtonTwoText}
                @click=${(e,t)=>e.closeCoachmark(t.event,b.a.Dismiss,x.a.Click,x.b.Hide,!0)}
                @keydown=${(e,t)=>e.lastElementKeyDownHandler(t.event)}
                ${Object(q.b)(e=>e.ctaButtonTwoTelemetryTag)}
            >
                ${e=>e.ctaButtonTwoText}
            </fluent-button>
`,ae=K.b`
   <div class="footer-actions">
         ${Object(G.a)(e=>e.ctaButtonOneText,ee)}
         ${Object(G.a)(e=>e.ctaButtonTwoText,te)}
    </div>
`,ne=K.b`
    <fluent-dialog class="dialog" part="dialog" id="coachmarkElement" @keydown=${(e,t)=>e.keyDownHandler(t.event)} style= width:${e=>e.coachmarkWidth}>   
     ${Object(G.a)(e=>e.showPointer||e.mainImage,Y)}
        <div class="main-container">
           <div class="coachmark_content">
                <div class="header">
                    ${Object(G.a)(e=>e.leadImage,X)}
                    <h1 class="header-title">${e=>e.titleText}</h1>
                </div>
                <div class="body">
                    <div class="input-container">
                  
                            ${e=>e.bodyText}

                    </div>
                </div>
            </div>
            ${Object(G.a)(e=>e.ctaButtonOneText||e.ctaButtonTwoText,ae)}
        </div>
          <fluent-button
                id="closeButton"
                appearance="stealth"
                class="close-button"
                title=${e=>e.cancelText}
                aria-label=${e=>e.cancelText}
                @click=${(e,t)=>e.closeCoachmark(t.event,b.a.Dismiss,x.a.Click,x.b.Close)}
                @keydown=${(e,t)=>e.closeButtonKeyDownHandler(t.event)}
                ${Object(q.b)(e=>e.cancelButtonTelemetryTag)}
            >
                <svg viewBox="0 0 16 16" width="16px" height="16px" xmlns="http://www.w3.org/2000/svg"><path d="M14.1016 1.60156L8.20312 7.5L14.1016 13.3984L13.3984 14.1016L7.5 8.20312L1.60156 14.1016L0.898438 13.3984L6.79688 7.5L0.898438 1.60156L1.60156 0.898438L7.5 6.79688L13.3984 0.898438L14.1016 1.60156Z"></path></svg>
            </fluent-button>
    </fluent-dialog>
`,ie=K.b`
${Object(G.a)(e=>e.addCoachmarkToPage,ne)}
`;var oe=a("kL0l"),re=a("CzTk"),ce=a("4X57");const se=ce.a`
    .close-button {
        left: auto;
        right: 16px;
    }
    .coachmark_leadImage {
        margin-left: auto;
        margin-right: 16px;
    }
`,de=ce.a`
    .close-button {
        left: 16px;
        right: auto;
    }
    .coachmark_leadImage {
        margin-left: 16px;
        margin-right: auto;
    }
`,le=ce.a`
    :host {
        --corner-radius: 2;
        --dialog-z-index: 0;
        --elevated-corner-radius: 4;
        position: relative;
    }

    h1 {
        cursor: default;
        font-weight: 600;
        font-size: 16px;
        line-height: 20px;
        margin-top: 0;
        margin-bottom: 0;
        color: ${oe.B.var};
    }

    .dialog {
        --dialog-height: var(--top-site-dialog-height, auto);
        --dialog-width: var(--top-site-dialog-width, auto);
        position: absolute;
        z-index: var(--top-site-dialog-z-index);
        top: var(--dialog-top, auto);
        bottom: var(--dialog-bottom, auto);
        left: var(--dialog-left, auto);
        right: var(--dialog-right, auto);
    }

    .main-container {
        padding: 16px 16px;
        display: grid;
        background-color: var(--neutral-layer-floating);
    }

    .header {
        grid-column: 2;
        grid-row: 1;
        letter-spacing: 0.6px;
        margin-bottom: 8px;
        line-height: 20px;
        text-align: left;
        font-weight: 600;
    }

    .close-button {
        position: absolute;
        min-width: 24px;
        height: 24px;
        top: 4px;
        left: 252px;
    }

    .close-button::part(control) {
        padding: 0;
        margin: 0;
    }

    .close-button svg {
        width: 10px;
        height: 10px;
    }

    .body {
        grid-column: 2;
        grid-row: 2;
        text-align: left;
        line-height: 20px;
        color: ${oe.B.var};
        justify-content: space-between;
    }

    .coachmark_ptr {
        position: absolute;
         color: ${oe.B.var};
    }

    .input-container {
        display: grid;
        line-height: 20px;
        font-size: var(--type-ramp-base-font-size);
        font-family: var(--body-font);
    }

    .coachmark-leadImage {
        width: 50px;
        margin-left: var(16px, auto);
        margin-right: var(16px, auto);
    }

    .coachmark-mainImage {
        margin: -16px -16px 0 -16px;
        padding: 0 0 12px 0;
    }

    .footer-actions {
        justify-content: center;
        box-sizing: border-box;
        display: grid;
        grid-template-columns: var(--top-site-dialog-button-width, 112px) var(--top-site-dialog-button-width, 112px);
        grid-gap: 8px;
        width: 100%;
        margin-top: 24px;
    }

    .coachmark_content {
        display: grid;
        grid-template-columns: max-content auto;
    }

    fluent-dialog::part(positioning-region) {
        position: var(--dialog-position, relative);
    }
`.withBehaviors(oe.B,oe.q,oe.v,new re.a(se,de)),he={experienceConfigSchema:p}},ttJo:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return i})),a.d(t,"m",(function(){return o})),a.d(t,"e",(function(){return r})),a.d(t,"f",(function(){return c})),a.d(t,"g",(function(){return s})),a.d(t,"h",(function(){return d})),a.d(t,"i",(function(){return l})),a.d(t,"j",(function(){return h})),a.d(t,"k",(function(){return m})),a.d(t,"l",(function(){return p})),a.d(t,"d",(function(){return u})),a.d(t,"a",(function(){return g}));const n="MyFeedPivotButton",i="PersonalizeButton",o="VoiceSearchButton",r="SettingsAdvancedButton",c="SettingsButton",s="SettingsCloseButton",d="SettingsCustomShowQuickLinksToggle",l="SettingsCustomButton",h="SettingsFocusedButton",m="SettingsInformationalButton",p="SettingsInspirationalButton",u="QuicklinksFirstLink",g="AddTopSiteButton"},wKWo:function(e,t,a){"use strict";var n=a("2JSu"),i=a("E3bb"),o=Object(n.a)(i.a);t.a=o}}]);